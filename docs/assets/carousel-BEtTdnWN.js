class C{constructor(o){this.element=o,this.init()}init(){const o=this.element.querySelector(".promo-carousel__container"),d=Array.from(this.element.querySelectorAll(".promo-carousel__slide")),p=this.element.querySelector(".promo-carousel__controls");if(!o||!d.length)return;let n=d.length;const L=this.element.classList.contains("promo-carousel--compact"),g=()=>{if(!L)return 1;const t=window.innerWidth||1920;return t<=480?1:t<=768?2:t<=1200?3:4};let l=g(),f=100/l,a=Math.min(l,n),x=Math.min(l,n),r=n>1?a:0,i=!1,y;const m=[];if(p){p.replaceChildren();for(let t=0;t<n;t++){const e=document.createElement("button");e.className=`promo-carousel__dot ${t===0?"promo-carousel__dot--active":""}`,e.addEventListener("click",()=>this.goToSlide(t)),p.appendChild(e),m.push(e)}}const c=document.createElement("button");c.className="promo-carousel__arrow promo-carousel__arrow--prev",c.setAttribute("aria-label","Предыдущие фото"),c.textContent="❮",c.addEventListener("click",t=>{t.stopPropagation(),this.prev()});const u=document.createElement("button");u.className="promo-carousel__arrow promo-carousel__arrow--next",u.setAttribute("aria-label","Следующие фото"),u.textContent="❯",u.addEventListener("click",t=>{t.stopPropagation(),this.next()}),this.element.appendChild(c),this.element.appendChild(u);const h=()=>{if(!m.length)return;const t=n>1?(r-1+n)%n:0;m.forEach((e,v)=>{e.classList.toggle("promo-carousel__dot--active",v===t)})},s=(t=!0)=>{if(t)o.style.transform=`translateX(-${r*f}%)`;else{const e=o.style.transition;o.style.transition="none",o.style.transform=`translateX(-${r*f}%)`,o.offsetWidth,o.style.transition=e||""}};if(n>1){for(let t=0;t<a;t++){const e=n-1-t,v=d[e].cloneNode(!0);o.insertBefore(v,o.firstChild)}for(let t=0;t<x;t++){const e=d[t].cloneNode(!0);o.appendChild(e)}s(!1),o.addEventListener("transitionend",()=>{i=!1;const t=a,e=a+n;r<t?(r+=n,s(!1)):r>=e&&(r-=n,s(!1)),h()})}else s(!1);this.goToSlide=t=>{if(i||n<=1)return;const e=t+a;e!==r&&(i=!0,r=e,s(!0),h())},this.prev=()=>{i||n<=1||(i=!0,r-=1,s(!0),h())},this.next=()=>{i||n<=1||(i=!0,r+=1,s(!0),h())},this.startAutoplay=function(){n<=1||(y=setInterval(()=>this.next(),8e3))},this.stopAutoplay=function(){clearInterval(y)},this.element.addEventListener("mouseenter",()=>this.stopAutoplay()),this.element.addEventListener("mouseleave",()=>this.startAutoplay()),this.element.addEventListener("touchstart",()=>this.stopAutoplay()),this.element.addEventListener("touchend",()=>this.startAutoplay()),this.element.classList.contains("promo-carousel--compact")&&this.element.addEventListener("click",t=>{t.target.closest(".promo-carousel__arrow")||t.target.closest(".promo-carousel__controls")||(t.target.closest("picture")||t.target.closest("img"))&&(typeof window.navigateTo=="function"?window.navigateTo("/gallery"):window.location.href="/gallery")});const A=()=>{const t=g();t!==l&&(l=t,f=100/l,s(!1))};window.addEventListener("resize",A),this.startAutoplay();let w=0,E=0;this.element.addEventListener("touchstart",t=>{w=t.touches[0].clientX}),this.element.addEventListener("touchmove",t=>{E=t.touches[0].clientX}),this.element.addEventListener("touchend",()=>{const t=E-w;Math.abs(t)>50&&(t>0?this.prev():this.next())})}}function S(_){return new C(_)}export{C as Carousel,S as initCarousel};
//# sourceMappingURL=carousel-BEtTdnWN.js.map
